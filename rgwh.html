<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>متجر رجوة</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    html, body { height:100%; overflow:hidden; }
    body {
      font-family: 'Tajawal', system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #008C9F 0%, #023649 100%);
      display: flex; align-items: center; justify-content: center;
      color: white; position: relative;
    }
    @keyframes float { 0%,100% { transform:translate(0,0); } 50% { transform:translate(30px,-30px); } }
    .container {
      text-align:center; padding:2.5rem 1.5rem; max-width:480px; width:100%;
      position:relative; z-index:1; animation:fadeInUp 0.8s ease-out;
    }
    @keyframes fadeInUp { from { opacity:0; transform:translateY(30px); } to { opacity:1; transform:translateY(0); } }
    .store-icon {
      width:80px; height:80px; margin:0 auto 1.5rem;
      background:rgba(255,255,255,0.2); border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      backdrop-filter:blur(10px); animation:pulse 2s ease-in-out infinite;
    }
    @keyframes pulse { 0%,100% { transform:scale(1); } 50% { transform:scale(1.05); } }
    .store-icon svg { width:50px; height:50px; fill:white; }
    h1 { font-size:2.5rem; margin-bottom:1rem; font-weight:700; letter-spacing:-0.5px; text-shadow:0 2px 10px rgba(0,0,0,0.2); }
    p.subtitle { font-size:1.2rem; opacity:0.95; margin-bottom:2.5rem; line-height:1.7; font-weight:400; }
    .btn {
      display:inline-flex; align-items:center; justify-content:center; gap:12px;
      padding:18px 50px; font-size:1.3rem; font-weight:600; color:white;
      background:linear-gradient(135deg, #25D366 0%, #128C7E 100%);
      border:none; border-radius:50px; cursor:pointer;
      transition:all 0.3s cubic-bezier(0.4,0,0.2,1);
      box-shadow:0 10px 30px rgba(37,211,102,0.4);
      text-decoration:none; position:relative; overflow:hidden; min-width:260px;
    }
    .btn::before {
      content:""; position:absolute; top:0; left:-100%; width:100%; height:100%;
      background:linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition:left 0.5s;
    }
    .btn:hover::before { left:100%; }
    .btn:hover { transform:translateY(-3px); box-shadow:0 15px 40px rgba(37,211,102,0.5); }
    .btn:active { transform:translateY(-1px); box-shadow:0 8px 20px rgba(37,211,102,0.4); }
    .btn.loading { pointer-events:none; opacity:0.9; }
    .btn.loading .btn-text { opacity:0.7; }
    .spinner {
      display:none; width:20px; height:20px;
      border:3px solid rgba(255,255,255,0.3); border-top-color:white;
      border-radius:50%; animation:spin 0.8s linear infinite;
    }
    .btn.loading .spinner { display:block; }
    @keyframes spin { to { transform:rotate(360deg); } }
    .info {
      margin-top:2.5rem; font-size:1rem; opacity:0.85;
      display:flex; align-items:center; justify-content:center; gap:8px;
      background:rgba(255,255,255,0.1); padding:12px 20px;
      border-radius:30px; backdrop-filter:blur(10px);
    }
    .whatsapp-float {
      position:fixed; width:60px; height:60px; bottom:25px; right:25px;
      background:#25D366; color:white; border-radius:50%; text-align:center;
      font-size:30px; box-shadow:0 10px 25px rgba(0,0,0,0.3); z-index:1000;
      display:flex; align-items:center; justify-content:center; transition:all 0.3s;
    }
    .whatsapp-float:hover { transform:scale(1.1); box-shadow:0 15px 35px rgba(0,0,0,0.4); }
    .whatsapp-float svg { width:36px; height:36px; fill:white; }
    @media (max-width:480px) {
      .container { padding:2rem 1.2rem; }
      .store-icon { width:70px; height:70px; }
      .store-icon svg { width:42px; height:42px; }
      h1 { font-size:2rem; }
      p.subtitle { font-size:1.1rem; }
      .btn { padding:16px 40px; font-size:1.2rem; min-width:240px; }
      .info { font-size:0.95rem; }
      .whatsapp-float { width:55px; height:55px; bottom:20px; right:20px; }
      .whatsapp-float svg { width:32px; height:32px; }
    }
  </style>
</head>
<body>

<div class="container">
  <h1>مرحباً بك</h1>
  <p class="subtitle">متجر رجوة للوحات المنزلية</p>

  <button type="button" class="btn" id="goBtn">
    <span class="btn-text">اطلب الآن</span>
    <div class="spinner"></div>
  </button>

  <div class="info">
    سينتقل للتواصل مباشرة
  </div>
</div>

<script>
(function () {
  // ────────────────────────────────────────────────
  // الإعدادات الأساسية
  // ────────────────────────────────────────────────
  const FORM_URL   = "https://submit.jotform.com/submit/242458007585461";
  const TARGET_URL = "https://wa.me/message/F5URG36PINYHB1";
  const VISIT_KEY  = "visitorHasBeenHere";

  const btn = document.getElementById("goBtn");

  // ────────────────────────────────────────────────
  // دالة لجلب التاريخ والوقت بدقة بتوقيت السعودية - نظام 12 ساعة
  // ────────────────────────────────────────────────
  function getSaudiDateTime12hr() {
    const options = {
      timeZone: 'Asia/Riyadh',
      year: 'numeric',
      month: '2-digit',
      day: '2-digit',
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
      hour12: true,
      hourCycle: 'h12'
    };

    const formatter = new Intl.DateTimeFormat('ar-SA', options);
    const parts = formatter.formatToParts(new Date());

    let date = '';
    let time = '';
    let period = '';

    parts.forEach(part => {
      if (part.type === 'year' || part.type === 'month' || part.type === 'day') {
        date += part.value;
        if (part.type !== 'day') date += '-';
      }
      if (part.type === 'hour') time = part.value;
      if (part.type === 'minute') time += ':' + part.value;
      if (part.type === 'second') time += ':' + part.value;
      if (part.type === 'dayPeriod') period = part.value;
    });

    // تنسيق نهائي: 2025-10-15 03:47:22 ص
    return `${date} ${time} ${period}`;
  }

  // ────────────────────────────────────────────────
  // جمع معلومات الزائر التفصيلية
  // ────────────────────────────────────────────────
  function getVisitorDetails(action) {
    const saTime = getSaudiDateTime12hr();
    return `${action} | ${saTime} | لغة المتصفح: ${navigator.language || 'غير معروف'} | اللغات: ${navigator.languages?.join(', ') || 'غير معروف'} | المنصة: ${navigator.platform || 'غير معروف'} | الشاشة: ${window.screen.width}×${window.screen.height} | User-Agent: ${navigator.userAgent} | المصدر: ${document.referrer || 'مباشر / غير معروف'}`;
  }

  // ────────────────────────────────────────────────
  // تسجيل الزائر الأول فقط (عند تحميل الصفحة)
  // ────────────────────────────────────────────────
  if (!localStorage.getItem(VISIT_KEY)) {
    const details = getVisitorDetails("زائر جديد");
    sendToJotform(details);
    localStorage.setItem(VISIT_KEY, "1");
  }

  // ────────────────────────────────────────────────
  // عند الضغط على الزر
  // ────────────────────────────────────────────────
  btn.addEventListener("click", async function (e) {
    e.preventDefault(); // احتياطي فقط
    btn.classList.add("loading");
    btn.disabled = true;

    try {
      const details = getVisitorDetails("ضغط على الزر");
      await sendToJotform(details);

      setTimeout(() => {
        window.location.href = TARGET_URL;
      }, 600);

    } catch (err) {
      console.error("خطأ أثناء إرسال البيانات:", err);
      window.location.href = TARGET_URL; // الانتقال حتى لو فشل الإرسال
    }
  });

  // ────────────────────────────────────────────────
  // دالة الإرسال إلى Jotform
  // ────────────────────────────────────────────────
  async function sendToJotform(message) {
    const data = new FormData();
    data.append("q10_name[first]", "تنبيه");
    data.append("q10_name[last]", message);

    try {
      await fetch(FORM_URL, {
        method: "POST",
        body: data,
        mode: "no-cors",
        keepalive: true,
        cache: "no-store"
      });
    } catch (e) {
      console.warn("فشل fetch (متوقع مع no-cors)", e);
    }
  }

})();
</script>
</body>
</html>